; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; Cleans c and punctuation out of 260|c data.
; Deletes second dates.
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'clean-260-dates
   [?\M-% ?c return return ?! ?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g tab return ?, ?  backspace ?. ?* ?$ return return ?\M-< ?\M-x ?\M-p return ?\\ ?\( ?\[ ?\\ ?| ?\] ?\\ ?\) return return ?\M-x ?\M-p return ?\[ ?\\ ?| ?\] return return ?\M-x ?\M-p return ?\\ ?\[ ?\\ ?| ?\\ ?\] return return ?\M-< ?\M-% return ?\M-% ?? return return ?! ?\M-< ?\M-x ?\M-p return ?\\ ?. ?  ?? ?$ left backspace ?* right return return ?\M-<])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; Delete "Jump to Record #..." from MARCedit find results
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'unjump-to-record
   [?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\C-q tab ?J ?u ?m ?p ?  ?t ?o ?. ?* ?$ return return ?\M-<])

(fset '830-unique-clean
   [?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g tab return ?^ ?= ?8 ?3 ?0 ?  ?  ?. ?. ?. ?. return return ?\M-< ?\M-x ?r ?e ?p ?l ?a tab ?r ?e ?g tab return ?\\ ?$ ?x ?. ?* ?$ return return ?\M-< ?\M-x ?r ?e ?p ?l ?a tab ?r ?e ?g tab return ?\; ?? ?\\ ?$ ?v ?. ?* ?$ return return ?\M-< ?\M-x ?r ?e ?p ?l ?a tab ?r ?e tab ?g tab return ?  ?+ ?$ return return ?\M-< ?\M-x ?\M-p return ?\\ ?. ?$ return return ?\M-< ?\M-x ?\M-p return ?, ?$ return return ?\M-< ?\C-x ?h ?s ?o ?r ?t backspace backspace backspace backspace ?\C-x ?h ?\M-x ?s ?o ?r ?t ?- ?l ?i ?n ?e ?s return ?\C-x ?h ?\M-x ?u ?n ?i ?q tab ?r ?e tab return])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; Do occur to find all with bad 300 coding.
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'check-300s-coding
   [?\M-s ?o ?^ ?= ?3 ?0 ?0 ?  ?  ?\\ ?\\ ?\\ ?\\ ?\\ ?$ ?a ?\\ ?\( ?\\ ?\( ?. ?* ?\\ ?\( ?\[ ?^ ?: ?\] ?\\ ?| ?\[ ?^ ?  ?\] ?: ?\\ ?\) ?\\ ?$ ?b ?\) backspace ?\\ ?\) ?\\ ?| ?\\ ?\( ?\[ ?^ ?$ ?\] ?* ?\\ ?\( ?i ?l ?l ?\\ ?| ?m ?a ?p ?\\ ?| ?p ?o ?r ?t ?\\ ?\) ?\\ ?\) ?\\ ?| ?\\ ?\( ?. ?* ?\\ ?\( ?\[ ?^ ?\; ?\] ?\\ ?| ?\[ ?^ ?  ?\] ?\; ?\\ ?\) ?\\ ?$ ?c ?\\ ?\) ?\\ ?| ?\\ ?\( ?. ?* ?\\ ?$ ?b ?\[ ?^ ?$ ?\] ?* ?\\ ?\( ?\[ ?0 ?- ?9 ?\] ?\\ ?| ?  ?\\ ?\) ?c ?m ?\\ ?\) ?\\ ?\) return])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; Moves records with 300s already fixed to the previously visited buffer, so that
;   the remaining ones can be eresourcified.
; Visit scratch and make sure it is empty before using.
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'move-eresourcified-300-records-to-previous-buffer
   [?\S-\C-\M-s ?^ ?= ?3 ?0 ?0 ?  ?  ?\\ ?\\ ?\\ ?\\ ?\\ ?$ ?a ?1 ?  ?o ?n ?l ?i ?n ?e ?\C-m ?\M-\{ ?\C-  ?\M-\} ?\C-w ?\C-x ?o ?\C-y return ?\C-x ?o])


; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; convert connexion coding to millennium coding
; input method must be ucs for this to work.
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'connexion-to-millennium
   [?\M-\{ ?\C-  ?\M-\} ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?  ?u ?0 ?1 ?c ?2 ?\\ ?\( ?. ?\\ ?\) ?  return ?| ?\\ ?1 return ?\C-e])



; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; downcase-title-proper - makes everything from second word of 245$a to the end of that subfield lowercase
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'downcase-title-proper
   [?\S-\C-\M-s ?^ ?= ?2 ?4 ?5 ?. ?* ?\\ ?$ ?a ?\C-m ?\M-f ?\C-  ?\S-\C-\M-s ?\\ ?$ ?\[ ?a ?- ?z ?\] ?\C-m ?\C-b ?\C-b ?\C-x ?\C-l])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; downcase-other-title-information - makes lowercase all of 245$b
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'downcase-other-title-information
   [?\S-\C-\M-s ?^ ?= ?2 ?4 ?5 ?. ?* ?\\ ?$ ?b ?\C-m ?\C-  ?\S-\C-\M-s ?\\ ?\( ?  ?/ ?\\ ?| ?\\ ?. ?$ ?\\ ?\) left ?\S-\C-\M-s ?\[ ?^ ?$ ?\] ?* ?\\ ?\( ?/ ?\\ ?| ?\\ ?. ?$ ?\\ ?\) ?\C-m ?\C-x ?\C-l])


; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; copy 490 data to an 830. does not check/correct non-filing indicators
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset '830-from-490
   [?\C-s ?= ?4 ?9 ?0 ?  ?  ?\\ ?\\ ?$ ?a ?\C-m ?\C-  ?\C-e ?\M-w return ?= ?8 ?3 ?0 ?  ?  ?\\ ?0 ?$ ?a ?\C-y ?.])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; change 440 data to a 490/830 combo. does not check/correct non-filing indicators
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset '440-to-490-830
   [?\C-s ?= ?4 ?4 ?0 ?  ?  ?\\ ?0 ?\C-m ?\C-  ?\C-e ?\M-w ?\C-a ?\C-f ?\C-f delete ?9 ?\C-f ?\C-f ?\C-f delete ?1 delete ?\\ ?\C-e return ?= ?8 ?3 ?0 ?  ?  ?\\ ?0 ?\C-y ?.])


; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; check marc encoding - marc8 and/or utf8?
; blanks = marc8 --- a = utf8
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'check-marc-encoding
   [?\M-s ?o ?= ?l ?d ?r return ?\C-x ?o ?\C-x ?h ?\M-w ?\C-x ?b ?s ?c ?r ?a ?t ?c ?h return ?\M-< ?\C-y ?\C-  ?\M-> ?\C-w ?\C-p ?\C-s ?= ?l ?d ?r ?  ?  ?\C-m ?\C-  ?\M-< ?\C-x ?r ?k ?\C-k ?\C-k ?\M-> ?\C-p ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-  ?\M-< ?\C-x ?r ?k ?\C-f ?\M-> ?\C-b ?\M-< ?\C-f ?\C-  ?\M-> ?\C-b ?\C-x ?r ?k ?\C-x ?h ?\M-x ?u ?n ?i ?q ?u ?i ?f ?y ?- ?b ?u tab return])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; process marcedit error logs
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'excelize-marcedit
   [?\M-x ?d ?e ?l ?e ?t ?e ?- ?m ?a ?t tab return ?R ?e ?c ?o ?r ?d ?  ?# ?: return ?\M-x ?\M-p return ?2 ?4 ?5 ?  ?\( ?i ?f return ?\M-x ?\M-p return ?E ?r ?r ?o ?r ?s ?: return ?\C-u ?1 ?0 ?0 ?0 ?0 ?\M-x ?e ?x ?c ?e ?l ?i ?z ?e ?- ?m ?a ?r ?c ?e ?d ?i ?t ?- ?e ?r ?r ?o ?r ?- ?l ?o ?g ?\M-x ?e ?x ?c ?e ?l ?i ?z ?e ?- ?m ?a ?r ?c ?e ?d ?i ?t ?- ?p ?o ?s ?t])

(fset 'excelize-marcedit-prep
   [?\M-x ?d ?e ?l ?e ?t ?e ?- ?m ?a ?t tab return ?R ?e ?c ?o ?r ?d ?  ?# ?: return ?\M-x ?\M-p return ?2 ?4 ?5 ?  ?\( ?i ?f return ?\M-x ?\M-p return ?E ?r ?r ?o ?r ?s ?: return])

(fset 'excelize-marcedit-error-log
   [?\C-s ?0 ?0 ?1 ?  ?\( ?\C-m ?\C-s ?: ?\C-f ?\C-f ?\C-  ?\C-e ?\M-w ?\C-n ?\C-a ?\C-  ?\C-s ?0 ?0 ?1 ?\C-a ?\C-b ?\C-x ?r ?t ?\C-y return ?\C-k])

(fset 'excelize-marcedit-post
   [?\C-a ?\C-b ?\C-  C-S-left ?\M-w ?\C-n ?\C-a ?\C-  ?\M-> ?\C-x ?r ?t ?\C-y return ?\M-< ?\M-x ?d ?e ?l ?e ?t ?e ?- ?m ?a ?t ?c ?i backspace ?h ?i ?n ?g ?- ?l ?i ?n ?e ?s return ?0 ?0 ?1 ?  ?\( ?i ?f return ?\C-x ?h ?\M-x ?s ?o ?r ?t ?- ?l ?i ?n ?e ?s return ?\C-  ?\S-\C-\M-s ?\\ ?w ?\C-a ?\C-w ?\C-x ?h ?\M-w])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; ensure title access
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'make-246-for-brackets-within-title-proper-words
   [?\S-\C-\M-s ?^ ?= ?2 ?4 ?5 ?. ?* ?\\ ?$ ?a ?. ?* ?\\ ?\( ?\[ ?a ?- ?z ?A ?- ?Z ?0 ?- ?9 ?\] ?\\ ?\[ ?\\ ?| ?\\ ?\] ?\[ ?a ?- ?z ?A ?- ?Z ?0 ?- ?9 ?\] ?\\ ?\) ?. ?* ?\\ ?$ ?h ?\C-m ?\C-b ?\C-b ?\C-  ?\C-r ?$ ?a ?\C-f ?\C-f ?\M-w ?\C-e return ?= ?2 ?4 ?6 ?b ?  ?  ?3 ?\\ ?$ ?a ?\C-y ?\C-  ?\C-a ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\\ ?\[ ?s ?i ?c ?\\ ?\] return ?z ?z ?z ?s ?i ?c ?z ?z ?z return ?\C-a ?\C-  ?\C-e ?\M-x ?\M-p return ?\\ ?\[ return return ?\C-a ?\C-  ?\C-e ?\M-x ?\M-p return ?\\ ?\] return return ?\C-a ?\C-  ?\C-e ?\M-x ?\M-p return ?z ?z ?z ?s ?i ?c ?z ?z ?z return ?\[ ?s ?i ?c ?\] return ?\C-s ?= ?l ?d ?r ?\C-m])

(fset 'make-246s-for-sic-in-title-proper
   [?\S-\C-\M-s ?^ ?= ?2 ?4 ?5 ?. ?* ?\\ ?$ ?a ?. ?* ?\\ ?\[ ?s ?i ?c ?\\ ?\] ?. ?* ?\\ ?$ ?h ?\C-m ?\C-b ?\C-b ?\C-  ?\C-r ?$ ?a ?\C-m ?\C-f ?\C-f ?\M-w ?\C-e return ?= ?2 ?4 ?6 ?s ?  ?  ?3 ?\\ ?$ ?a ?\C-y return ?= ?2 ?4 ?6 ?c ?s ?  ?  ?3 ?\\ ?$ ?a ?\C-y ?\C-  ?\C-a ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?s backspace ?x ?p return ?  ?? ?\\ ?\[ ?s ?i ?c ?\\ ?\] ?  ?? return ?  return ?\C-s ?= ?l ?d ?r ?\C-m])

(fset 'remove-eol-punctuation-246
   [?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?^ ?\\ ?\( ?= ?2 ?4 ?6 ?. ?* ?\\ ?w ?\\ ?\) ?\\ ?W ?$ return ?\\ ?1 return])

;;;; Find, at beginning of $a, initial articles.
;;;; Delete and capitalize first letter of the rest of the title.
;;;; replace-regexp
;; \(=246.*\$a\)\(A \|An \|Das \|De \|Die \|La \|Las \|L'\|The \)\(.\)
;; \1\,(capitalize \3)
(fset '246-initial-articles-capitalize
   [?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?^ ?\\ ?\( ?= ?2 ?4 ?6 ?. ?* ?\\ ?$ ?a ?\\ ?\) ?\\ ?\( ?A ?  ?\\ ?| ?A ?n ?  ?\\ ?| ?D ?a backspace backspace ?T ?h ?e ?  ?\\ ?| backspace ?\) ?\\ ?\( ?. ?\\ ?\) return ?\\ ?1 ?\\ ?, ?\( ?c ?a ?p ?i ?t ?a ?l ?i ?z ?e ?  ?\\ ?3 ?\) return])

; removes [sic], [, and ] from 246s and 246b
(fset 'clean-246-b-or-s
   [?\S-\C-\M-s ?= ?2 ?4 ?6 ?\[ ?s ?b ?\] ?. ?* ?\\ ?\[ ?s ?i ?c ?\\ ?\] ?\C-m ?\C-e ?\C-  ?\C-a ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e tab return ?  ?* ?\\ ?\[ ?s ?i ?c ?\\ ?\] ?  ?* return ?  return ?\C-a ?\C-  ?\C-e ?\M-x ?\M-p return ?\\ ?\( ?\\ ?\[ ?\\ ?| ?\\ ?\] ?\\ ?\) return return ?\C-e])

(fset '246-alternate-title
   [?\S-\C-\M-s ?^ ?= ?2 ?4 ?5 ?. ?* ?\\ ?$ ?a ?. ?* ?\[ ?, ?: ?\; ?\] ?  ?\[ ?O ?o ?\] ?r ?, ?  ?. ?* ?\\ ?$ ?h ?\C-m ?\C-b ?\C-b ?\C-r ?  ?o ?r ?, ?  ?\C-m ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-  ?\C-s ?$ ?h ?\C-b ?\C-b ?\M-w ?\C-e return ?= ?2 ?4 ?6 ?  ?  ?1 ?0 ?$ ?a ?\C-y])

; After creating a new 246 without [sic], create a copy of that one in which to make corrections.
(fset '246-duplicate-sicless
   [?\C-s ?= ?2 ?4 ?6 ?s ?\C-m ?\C-a ?\C-  ?\C-e ?\M-w return ?\C-y ?\C-a ?\C-f ?\C-f ?\C-f ?\C-f ?e ?\C-s ?= ?L ?D ?R ?\C-m])

; Start on a blank line at top of file or between records. Sorts all the lines in a record, starting after the =LDR.
(fset 'sort-marcedit-record-lines
   [?\C-s ?= ?l ?d ?r ?\C-m ?\C-n ?\C-a ?\C-  ?\M-\} ?\C-b ?\M-x ?s ?o ?r ?t ?- ?l ?i ?n ?e ?s return])

; Delete 650s that contain only: =650  ??$vEarly works to 1800
(fset 'delete-650s-with-only-Early-works-1800 [?\S-\C-\M-s ?^ ?= ?6 ?5 ?0 ?  ?  ?. ?. ?\\ ?$ ?v ?E ?a ?r ?l ?y ?  ?w ?o ?r ?k ?s ?  ?t ?o ?  ?1 ?8 ?0 ?0 ?\\ ?\( ?\\ ?| ?\\ ?. ?\\ ?\) ?  ?? ?$ ?\C-m ?\C-a ?\C-k ?\C-k ?\C-p])

;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; 300 magic
;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

; check for 300s with illustrative matter statements, but no $b
(fset '300-no-subf-b
   [?\M-s ?o ?^ ?= ?3 ?0 ?0 ?. ?* ?\\ ?$ ?a ?\[ ?^ ?$ ?\] ?* ?\\ ?\( ?i ?l ?l ?\\ ?| ?p ?o ?r ?t ?| ?\\ backspace backspace ?\\ ?| ?m ?a ?p ?\\ ?\) return])

; check for 300s with dimension statements, but no $c
(fset '300-no-subf-c
   [?\M-s ?o ?^ ?= ?3 ?0 ?0 ?. ?* ?\\ ?$ ?a ?\\ ?\( ?. ?* ?\\ ?$ ?b ?\[ ?^ ?$ ?\] ?* ?\\ ?| ?\[ ?^ ?$ ?\] ?* ?\\ ?| ?. ?* ?\[ ?^ ?c ?0 ?- ?9 ?\] ?\[ ?0 ?- ?9 ?\] ?+ ?  ?? ?\\ ?\) ?c ?m ?\\ ?. ?? ?  ?? ?$ return])

; get 300s from a file, put them in scratch.
; delete everything before $a data
; delete any fields without $b or $c
; sort and uniquify
;;;; WARNINGS
;;;; Run only after making sure illustration and dimension data are in the right subfields
;;;; Will overwrite contents of scratch file
(fset 'get-300s-with-ill-or-dim
   [?\M-s ?o ?^ ?3 backspace ?= ?3 ?0 ?0 return ?\C-x ?o ?\C-x ?h ?\M-w ?\C-x ?b ?* ?s ?c ?r ?a ?t ?c ?h ?* return ?\M-< ?\C-y ?\C-  ?\M-> ?\C-w ?\C-r ?= ?3 ?0 ?0 ?\C-m ?\C-  ?\M-< ?\C-x ?r ?k ?\M-> ?\C-r ?$ ?a ?\C-m ?\C-f ?\C-f ?\C-  ?\M-< ?\C-x ?r ?k ?\C-k ?\C-k ?\C-x ?1 ?\C-x ?h ?\M-x ?s ?o ?r ?t ?- ?l ?i ?n ?e ?s return ?\M-x ?u ?n ?i ?q ?u ?i ?f ?y ?- ?b ?u ?f ?f ?e ?r ?- ?l ?i ?n ?e ?s return ?\M-x ?d ?e ?l ?e ?t ?e ?- ?n ?o ?n ?- ?m ?a ?t ?c ?h ?i ?n ?g ?- ?l ?i ?n ?e ?s return ?\\ ?$ return])

;;; Run on list created with get-300s-with-ill-or-dim
; Deletes everything up to the 2 characters preceding the first $ on each line

(fset 'delete-300-a-values-reduce
   [?\C-\M-% ?^ ?. ?* ?\\ ?\( ?. ?. ?\\ ?$ ?\\ ?\) return ?\\ ?1 return ?! ?\M-< ?\C-x ?h ?\M-x ?s ?o ?r ?t ?- ?l ?i ?n ?e ?s return ?\M-x ?u ?n ?i ?q ?u ?i ?f ?y ?- ?b ?u ?f ?f ?e ?r ?- ?l ?i ?n ?e ?s return])


; reduces list to subfield delimiters and their two preceding characters
; run starting at top of file
(fset '300-subfield-b-c-preceders
   [?\C-s ?$ ?\C-m ?\C-b ?\C-b ?\C-b ?\C-  ?\C-a ?\C-w ?\C-s ?$ ?\C-m ?\C-f ?\C-  ?\C-s ?$ ?\C-m ?\C-b ?\C-b ?\C-b ?\C-b ?\C-f ?\C-w return])

; reduces list to unique preceder/subfield combinations
(fset '300-subfield-b-c-preceder-cleanup
   [?\C-x ?h ?\M-x ?s ?o ?r ?t ?- ?l ?i ?n ?e ?s return ?\M-x ?u ?n ?i ?q ?u ?i ?f ?y ?- ?b ?u ?f ?f ?e ?r ?- ?l ?i ?n ?e ?s return])


; use on lists of 300s with $a delimiter already removed
; makes any line containing $b begin with ..$b (where . is anything)
(fset '300-start-with-b
   [?\C-s ?$ ?b ?\C-m ?\C-a ?\C-  ?\C-s ?$ ?\C-m ?\C-b ?\C-b ?\C-b ?\C-b ?\C-w delete ?\C-n])

; eresourcifies the cleaned-up 300s
; opens a split window to show processed 300s.
(fset '300-eresource
   [?\M-< ?\C-\M-% ?\\ ?\( ?= ?3 ?0 ?0 ?. ?* ?\\ ?\) ?  ?\; ?\\ ?$ ?c ?. ?* ?$ return ?\\ ?1 return ?! ?\M-< ?\C-\M-% ?\\ ?\( ?= ?3 ?0 ?0 ?. ?* ?\\ ?$ ?a ?\\ ?\) ?\\ ?\( ?. ?* ?? ?\\ ?\) ?\\ ?\( ?  ?* ?$ ?\\ ?| ?  ?* ?: ?\\ ?$ ?b ?\\ ?\) return ?\\ ?1 ?1 ?o backspace ?  ?o ?n ?l ?i ?n ?e ?  ?r ?e ?s ?o ?u ?r ?c ?e ?  ?\( ?\\ ?2 ?\) ?\\ ?3 return ?! ?\M-< ?\M-s ?o ?= ?3 ?0 ?0 return])


; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; should be done with these.
;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
;; ; Takes copy/pasted field tags from nav bar of OCLC Input Standards and moves each to a new line
;; (fset 'unpack-marc-code-list
;;    [?\C-s ?  ?\C-m ?\C-b ?\C-  ?\S-\C-\M-s ?\[ ?0 ?- ?9 ?\] ?\\ ?\{ ?3 ?\\ ?\} ?\C-m ?\C-b ?\C-b ?\C-b return])

;; ; Takes list of unpacked marc field tags and turns them into AutoHotKey hotstrings
;; (fset 'marc-tag-to-hotstring
;;    [?\C-a ?\C-f ?\C-f ?\C-f ?\C-  ?\C-e ?\C-w ?\C-a ?\C-  ?\C-f ?\M-w ?\C-a ?\C-  ?\C-f ?\C-f ?\C-f ?\M-w ?\C-a ?: ?: ?\C-e ?: ?: return ?R ?u ?n ?  ?h ?t ?t ?p ?: ?/ ?/ ?w ?w ?w ?. ?o ?c ?l ?c ?. ?o ?r ?g ?/ ?u ?s ?/ ?e ?n ?/ ?b ?i ?b ?f ?o ?r ?m ?a ?t ?s ?/ ?e ?n ?/ ?\C-y backspace backspace ?x ?x ?/ ?\C-y ?. ?s ?h ?t ?m return ?r ?e ?t ?u ?r ?n return ?\C-n])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; Frequently used search strings
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; 245 - [ or ] not at word boundaries
;  =245.*\$a.*\[\B.*\]\B.*\$h

;; \(=246.*\$a\)\(A \|An \|Das \|De \|Die \|La \|Las \|L'\|The \)\(.\)
;; \1\,(capitalize \3)

; 245 - Find 245s where the original GMD wasn't removed when converting to an e-record.
;  =245.*\$a.*\[micro.*\].*\$h

; 260 - Find records with 2 260 fields, separated by 0 or more lines
;; =260.*\(
;; =.*\)*?
;; =260

;; Take old GMD out of title proper
;; \(=245.*\$a.*\) ?\[micro.*\] ?.*\(\$h\)
;; \1 \2

;; Get things with NO punctuation preceding $b
;; =300.*[.a-z,]\$b

;; Correct pre-$b punctuation
;; \(=300.*[.a-z,]\)\(\$b\)
;; \1 :\2

;; Correct pre-$b punctuation
;; \(=300.*\);\(\$b\)
;; \1:\2

;; Delete $c
;; \(=300.*\);?\$c.*
;; \1

;; E-resourcify
;; \(=300.*\$a\)\(.*?\)\( *$\| *:\$b\)
;; \11 online resource (\2)\3

;; =245.*\$a.+\(\[\|\]\)\B.+\$h
;; c-a
;; delete sic
;; delete lone []s
;; delete eol punct
;; delete init article

(fset 'position-for-bracket-tp-copy
   [?\S-\C-\M-s ?= ?2 ?4 ?5 ?. ?* ?\\ ?$ ?a ?\\ ?w ?. ?* ?\\ ?\( ?\\ ?B ?\\ ?\{ ?\C-? ?\[ ?\\ ?| ?\\ ?B ?\\ ?\] ?\\ ?\) ?. ?* ?\C-? ?\C-? ?\\ ?w ?. ?\C-? ?\C-? ?\C-? ?. ?* ?\\ ?$ ?h ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?\C-? ?. ?* ?\\ ?\( ?\\ ?w ?\\ ?\[ ?\\ ?| ?\\ ?\] ?\\ ?w ?\\ ?\) ?. ?* ?\\ ?$ ?h ?\C-m ?\C-b ?\C-b])

(fset 'delete-sics
   [?\C-a ?\C-  ?\C-e ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?  ?? ?\\ ?\[ ?s ?i ?c ?\\ ?\] ?  ?? return ?  return])

(fset 'delete-square-brackets
   [?\C-a ?\C-  ?\C-e ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?s backspace ?x ?p return ?\\ ?\( ?\\ ?\[ ?\\ ?| ?\\ ?\] ?\\ ?\) return return])

(fset 'delete-eol-punct-and-spaces
   [?\C-a ?\C-  ?\C-e ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\\ ?W ?+ ?$ return return])

(fset 'remove-initial-articles-and-capitalize
   [?\C-a ?\C-  ?\C-e ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\\ ?\( ?\\ ?$ ?a ?\\ ?\) ?\\ ?\( ?A ?  ?\\ ?| ?A ?n ?  ?\\ ?| ?T ?h ?e ?  ?\\ ?\) ?\\ ?\( ?. ?\\ ?\) return ?\\ ?1 ?, backspace ?\\ ?, ?\( ?c ?a ?p ?t backspace ?i ?t ?a ?l ?i ?z ?e ?  ?\\ ?3 ?\) return])

(fset 'process-intra-word-square-bracket-variant-titles
   [?\M-x ?p ?o ?s ?i ?t ?i ?o ?n ?- ?f ?o ?r ?- ?b ?r ?a ?c ?k ?e ?t ?- ?t ?p ?- ?c ?o ?p ?y return ?\C-  ?\C-r ?$ ?a ?\C-m ?\C-f ?\C-f ?\M-w ?\C-e return ?= ?2 ?4 ?6 ?b ?  ?  ?3 ?\\ ?$ ?a ?\C-y ?\M-x ?d ?e ?l ?e ?t ?e ?- ?s ?i ?c ?s return ?\M-x ?d ?e ?l ?e ?t ?e ?- ?s ?q ?u ?a ?r ?e ?- ?b ?r ?a ?c ?k ?e ?t ?s return ?\C-a ?\C-  ?\C-e ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\\ ?? ?\\ ?\( ?\\ ?w ?\\ ?\) return ?\\ ?1 return ?\M-x ?d ?e ?l ?e ?t ?e ?- ?e ?o ?l ?- ?p ?u ?n ?c ?t ?- ?a ?n ?d ?- ?s ?p ?a ?c ?e ?s return ?\M-x ?r ?e ?m ?o ?v ?e ?- ?i ?n ?i ?t ?i ?a ?l ?- ?a ?r ?t ?i ?c ?l ?e ?s ?- ?a ?n ?d ?- ?c ?a ?p ?i ?t ?a ?l ?i ?z ?e return ?\C-n])

(fset 'eresourcify-300
   [?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\\ ?\( ?= ?3 ?0 ?0 ?. ?* ?\\ ?\) ?  ?* ?\; ?\\ ?$ ?c ?. ?* ?$ return ?\\ ?1 return ?\M-< ?\M-x ?\M-p return ?\\ ?\( ?= ?3 ?0 ?0 ?. ?* ?\\ ?$ ?a ?\\ ?\) ?\\ ?\( ?. ?* ?? ?\\ ?\) ?\\ ?\( ?  ?* ?$ ?\\ ?| ?  ?* ?: ?\\ ?$ ?b ?\\ ?\) return ?\\ ?1 ?1 ?  ?o ?n ?l ?i ?n ?e ?  ?r ?e ?s ?o ?u ?r ?c ?e ?  ?\( ?\\ ?2 ?\) ?\\ ?3 return])

; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
; process ERT page source code to titles
; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

; Before running this, remove everything from top of page to beginning of first title. Place cursor at end of first title line.
(fset 'ert-leave-only-titles
   [?\C-  ?\C-s ?< ?a ?  ?h ?r ?e ?f ?= ?\" ?h ?t ?t ?p ?: ?/ ?/ ?e ?r ?e ?s ?o ?u ?r ?c ?e ?s ?. ?l ?i ?b ?\C-m ?\C-e ?\C-w ?\C-n ?\C-e])

; Search for lines beginning with "> and see what is missing.

; remove html codes, replace ampersand code, remove spaces from beginning and end of lines, sort lines, remove blank lines
(fset 'ert-process-titles
   [?\M-x ?r ?e ?g backspace ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?s ?p backspace backspace ?s backspace ?x ?p return ?< ?/ ?? ?\[ ?a ?b ?\] ?> return return ?\M-< ?\M-% ?& ?a ?m ?p ?\; return ?& return ?! ?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?^ ?  ?* return return ?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\[ ?^ ?  ?\] backspace backspace backspace backspace ?\\ ?\( ?\[ ?^ ?  ?\] ?\\ ?\) ?  ?* ?$ return ?\\ ?1 return ?\M-< ?\M-x ?s ?o ?r ?t ?- ?l ?i ?n ?e ?s return ?\C-  ?\S-\C-\M-s ?^ ?\[ ?A ?- ?Z ?a ?- ?z ?0 ?- ?9 ?\] ?\C-m ?\C-b ?\C-w])

; Do replace-regexp
; </?[ba]>
; {null}

(fset 'todb1
   [?\S-\C-\M-s ?^ ?= ?8 ?5 ?6 ?. ?* ?\\ ?$ ?x ?\C-m backspace backspace ?\C-  ?\S-\C-\M-s ?\\ ?\( ?$ ?\\ ?| ?\\ ?$ ?\\ ?\) ?\C-m ?\C-w ?\C-x ?b return ?\" ?\C-y ?\" ?\; ?\C-x ?b return ?\S-\C-\M-r ?^ ?= ?0 ?0 ?1 ?  ?  ?s ?\C-m ?\C-s ?s ?\C-m ?\C-b ?\C-  ?\C-e ?\M-w ?\C-x ?b return ?\" ?\C-y ?\" ?\; ?\C-x ?b return ?\S-\C-\M-s ?^ ?= ?2 ?4 ?5 ?. ?* ?\\ ?$ ?a ?\C-m ?\C-  ?\C-s ?$ ?\C-m ?\C-b ?\M-w ?\C-x ?b return ?\" ?\C-y ?\" ?\; ?\C-x ?b return ?\C-s ?= ?8 ?5 ?6 ?\C-m ?\C-s ?$ ?u ?\C-m ?\C-  ?\S-\C-\M-s ?= ?m ?a ?r ?c ?\\ ?\( ?\\ ?$ ?\\ ?| ?$ ?\\ ?\) ?\C-m ?\C-r ?c ?\C-m ?\C-f ?\C-  ?\C-r ?$ ?u ?\C-f ?\C-f ?\M-w ?\C-x ?b return ?\" ?\C-y ?\" return ?\C-x ?b return ?\C-r ?= ?2 ?4 ?5 ?\C-m ?\C-x ?b return ?\C-x ?\C-s ?\C-x ?b return])

(fset 'linkend-fix
   [?\S-\C-\M-s ?= ?m ?a ?r ?c ?\\ ?\( ?\\ ?$ ?\\ ?| ?$ ?\\ ?\) ?\C-m ?\C-r ?c ?\C-m ?\C-f])

; Know this works on the first use/blind reference report.
; Run with cursor at start of first line
; Run once for each line
; Results in .csv format
(fset 'millennium-authority-report-first-blind-process
   [?\C-  ?\C-s ?\C-i ?\C-s ?\C-m ?\C-w ?\" ?\C-s ?\C-i ?\C-m ?\S-\C-\M-r ?\[ ?0 ?- ?9 ?a ?- ?z ?\] ?\C-m ?\C-f ?\C-  ?\C-s ?< ?/ ?b ?> ?  ?\C-m ?\C-w ?\" ?, ?\" ?\C-s ?< ?b ?r ?\C-m ?\C-b ?\C-b ?\C-b ?\C-  ?\C-s ?< ?b ?> ?\C-s ?\C-m ?\C-w ?\" ?, ?\" ?\C-s ?< ?/ ?b ?> ?\C-m ?\C-b ?\C-b ?\C-b ?\C-b ?\C-  ?\C-s ?< ?i ?> ?\C-m ?\C-w ?\" ?, ?\" ?\C-s ?< ?/ ?i ?> ?\C-m ?\C-b ?\C-b ?\C-b ?\C-b ?\C-  ?\C-s ?\" ?\C-b ?\C-w ?\" ?, ?\C-f ?\C-  ?\C-s ?\" ?\C-m ?\C-b ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?< ?\\ ?/ ?? ?B ?> return return ?\C-f ?\C-  ?> backspace ?\C-  ?\C-s ?> ?  ?\C-w ?\M-b return backspace ?\C-  ?\C-r ?\" ?\C-m ?\C-f ?\C-w ?, ?\" ?\C-s ?< ?/ ?i ?\C-m ?\C-b ?\C-b ?\C-b ?\C-  ?\C-s ?\" ?\C-b ?\C-w ?\" ?, ?\C-f ?\C-  ?\C-s ?\" ?\C-m ?\C-b ?\M-x ?\M-p ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p ?\C-k return ?< ?\\ ?/ ?? ?B ?> return return ?\C-f ?\C-  ?\C-s ?> ?  ?\C-m ?\C-w ?, ?\" ?\C-s ?< ?/ ?i ?> ?\C-m ?\C-b ?\C-b ?\C-b ?\C-b ?\C-  ?\C-s ?< ?/ ?b ?> ?  ?\C-m ?\C-w ?\" ?, ?\" ?\C-s ?  ?\C-m backspace ?\" ?, ?\" ?\C-s ?\C-i ?\C-m ?\C-  ?\S-\C-\M-r ?\[ ?0 ?- ?9 ?a ?- ?z ?\] ?\C-m ?\C-f ?\C-w ?\" ?, ?\" ?\C-s ?\C-i ?\C-m ?\C-  ?\S-\C-\M-r ?\[ ?0 ?- ?9 ?a ?- ?z ?\] ?\C-m ?\C-f ?\C-w ?\" ?, ?\" ?\C-s ?\C-i ?\C-m ?\C-  ?\S-\C-\M-r ?\[ ?a ?- ?z ?0 ?- ?9 ?\] ?\C-m ?\C-f ?\C-w ?\" ?, ?\" ?\C-s ?\C-i ?\C-m ?\C-  ?\S-\C-\M-r ?\[ ?0 ?- ?9 ?a ?- ?z ?\] ?\C-m ?\C-f ?\C-w ?\" ?, ?\" ?\C-s ?\C-i ?\C-m ?\C-  ?\S-\C-\M-r ?\[ ?0 ?- ?9 ?a ?- ?z ?\] ?\C-m ?\C-f ?\C-w ?\" ?, ?\" ?\C-n ?\C-a backspace ?  ?\C-e ?\" ?\C-n ?\C-a])

;; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
;; normalize millennium output - breaks lines at semicolon - will not handle quotes surrounding
;; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
(fset 'normalize-millennium-output
   [?\C-s ?\; ?\C-m ?\C-e ?\C-r ?\; ?\C-m delete ?\C-  ?\C-e ?\C-w return ?\C-y ?\C-p ?\C-a ?\C-  ?\M-f ?\M-w ?\C-n ?\C-a ?\C-y tab ?\C-p ?\C-a])

;; Insert OCLC dagger subfield delimiter!
;; Mix of info from http://www.emacswiki.org/emacs/KeyBindingDiscussion
;;  and http://www.emacswiki.org/emacs/PrefixKey
  (defun insert-oclc-dagger ()
    "Insert OCLC dagger subfield delimiter!"
    (interactive)
    (insert "ǂ"))

(global-set-key (kbd "C-c d") 'insert-oclc-dagger)


;; Replace spaceless dollars with spaced daggers.
(fset 'marcedit-to-oclc-syntax
   [?\C-a ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\\ ?$ ?\\ ?\( ?. ?\\ ?\) return ?  ?\C-c ?d ?\\ ?1 ?  return ?\C-a ?\C-  ?\C-e ?\M-w return])

(global-set-key (kbd "C-c C-o") 'marcedit-to-oclc-syntax)

(fset 'normalize-titles
   [?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?\\ ?\( ?\[ ?. ?, ?\; ?: ?\' ?\" ?\( ?\) ?\\ ?/ ?\] ?\\ ?| ?- ?\\ ?| ?\[ ?\\ ?| ?\] ?\\ ?\) return ?  return ?\M-< ?\M-% ?& return ?a ?n ?d return ?! ?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?^ ?  ?+ return return ?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?  ?+ ?$ return return ?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?  ?+ return ?  return ?\M-< ?\M-< ?\C-  ?\M-> ?\C-x ?\C-l ?\M-<])

(fset 'iii-global-update-fields-to-tab-delimited
   [?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?^ ?\C-q tab ?\[ ?0 ?- ?9 ?\] ?+ ?\C-q tab ?. ?\C-q tab ?  ?\C-q tab ?G ?r ?o ?u ?p ?: ?  ?. ?  ?. ?. ?. ?. ?. ?\C-b ?\C-b ?\C-b ?\C-b ?\C-b ?\\ ?\( ?\C-e ?\\ ?\) ?\\ ?\( ?. ?* ?\\ ?\) ?E ?x ?p ?a ?n ?d ?e ?d ?: ?  ?f ?a ?l ?s ?e ?  ?E ?n ?t ?r ?i ?e ?s ?: ?  ?\[ ?0 ?- ?9 ?\] ?+ return ?\\ ?1 ?\C-q tab ?\\ ?2 return])

(fset 'marcedit-copy-from-find-cleanup
   [?\M-< ?\C-  ?\M-> ?\C-a ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-f ?\C-x ?r ?k ?\M-< ?\M-x ?r ?e ?p ?l ?a ?c ?e ?- ?r ?e ?g ?e ?x ?p return ?  ?* ?\C-q tab ?J ?u ?m ?p ?  ?t ?o ?  ?R ?e ?c ?. ?* ?$ return return]
)
